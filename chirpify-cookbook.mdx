---
title: "Build a Text-to-Speech App with Per-Character Billing"
description: "Ship a production-ready TTS app with ElevenLabs and Dodo Payments. Free tier, credit packs, checkout -- the whole thing in under an hour."
---

# Chirpify AI: Text-to-Speech with Per-Character Billing

Most TTS tutorials stop at "call the API and play audio." This one doesn't.

By the end of this cookbook, you'll have a fully deployed text-to-speech app that lets users type text, pick a voice, generate speech, and pay you for it -- with a freemium model, three credit tiers, and a real checkout flow. The kind of thing you'd actually put a domain on.

<img src="/images/chirpify-demo.png" alt="Chirpify AI Demo" />

<Card title="Full Source Code" icon="github" href="https://github.com/aainanarang29/chirpify-ai">
  Skip the tutorial. Clone, configure, deploy. Every file referenced below lives here.
</Card>

---

## What You'll Ship

Not a toy. Not a tutorial that "leaves the rest as an exercise." An actual product:

- **ElevenLabs TTS** with 5 voice options -- type text, hear it spoken back
- **Freemium model** -- 500 free characters on first visit, no signup needed
- **Three credit packs** -- Starter (10K), Pro (50K), Power (200K) characters
- **Dodo Payments checkout** -- real payment links, real receipts, test mode for dev
- **Live credit tracking** -- balance updates in real-time, color-coded warnings when running low
- **One-command deploy** -- `vercel --prod` and you're live

Total cost to build and host: **$0**.

---

## Architecture

{/* üé® EXCALIDRAW DIAGRAM #1: Architecture Overview */}

<img src="/images/architecture-diagram.svg" alt="Architecture: Frontend ‚Üí Vercel Edge Functions ‚Üí ElevenLabs TTS API, with localStorage for credits and Dodo Payments for checkout" />

Three layers, zero complexity. Your **frontend** talks to **Vercel serverless functions** that do two things: hit ElevenLabs for audio generation and hit Dodo for payment sessions. Credits live in `localStorage` -- simple, instant, no database needed for the demo.

<Accordion title="Full tech stack">

| Layer | Technology | Why |
| --- | --- | --- |
| Frontend | HTML5, CSS3, vanilla JS | No framework overhead. Ships fast. |
| Backend | Node.js 18+, Vercel Serverless | Two API routes. That's it. |
| TTS | ElevenLabs API | Best-in-class voices. Free tier = 10K chars/month. |
| Payments | Dodo Payments | One API call to create a payment link. Handles tax, receipts, everything. |
| Hosting | Vercel | Push to GitHub, it's live. SSL included. |
| State | localStorage | Good enough for a demo. Swap for a DB when you're ready. |

</Accordion>

---

## Pricing Model

Chirpify uses the same model as ElevenLabs, Resend, and most usage-based SaaS: buy credits upfront, spend them as you go.

| Pack | Characters | Price | Per 1K chars | Who it's for |
| --- | --- | --- | --- | --- |
| üü¢ Starter | 10,000 | $5 | $0.50 | Kicking the tires |
| üîµ Pro | 50,000 | $10 | $0.20 | Regular use |
| üü£ Power | 200,000 | $25 | $0.125 | Volume users |

The more you buy, the cheaper it gets. Classic volume discount -- nothing fancy, but it works because users self-select into the tier that matches their usage.

---

## Step 1: Set Up Products in Dodo

Before writing any code, you need three products in Dodo -- one for each credit pack. Two ways to do this.

### Option A: The Dashboard (2 minutes, no code)

{/* üé• VIDEO #1: "How to Add API Key in Dodo"
   <Frame caption="Getting your Dodo API key">
     <video controls src="/videos/dodo-api-key-setup.mp4" />
   </Frame>
*/}

{/* üé• VIDEO #2: "How to Add Products in Dodo"
   <Frame caption="Creating your credit pack products">
     <video controls src="/videos/dodo-create-products.mp4" />
   </Frame>
*/}

<Steps>
  <Step title="Grab your API key">
    Head to your [Dodo Payments Dashboard](https://dashboard.dodopayments.com) ‚Üí **API Keys** ‚Üí generate a new key. Stash it somewhere safe. You'll need it in Step 2.
  </Step>
  <Step title="Create the Starter Pack">
    **Products ‚Üí Create Product**. Name it "Starter Pack", set the price to $5.00 USD, type to one-time payment, tax category to Digital Products. Hit **Create**, copy the `product_id`. Done.
  </Step>
  <Step title="Repeat for Pro and Power">
    Same flow. Pro Pack = $10 (50K characters). Power Pack = $25 (200K characters). Save all three `product_id` values -- you'll plug them into your checkout API next.
  </Step>
</Steps>

### Option B: cURL it

If clicking buttons isn't your thing:

```bash
curl -X POST "https://test.dodopayments.com/products" \
  -H "Authorization: Bearer YOUR_DODO_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Starter Pack",
    "description": "10,000 characters for text-to-speech",
    "price": {
      "currency": "USD",
      "price": 500,
      "type": "one_time_price"
    },
    "tax_category": "digital_products"
  }'
```

<Card title="All three cURL commands" icon="github" href="https://github.com/aainanarang29/chirpify-ai#create-products">
  Starter, Pro, and Power pack creation -- copy, paste, run.
</Card>

<Info>
`test.dodopayments.com` for development. `live.dodopayments.com` when you're ready for real money.
</Info>

---

## Step 2: Build the Checkout API

User clicks "Buy" ‚Üí your API creates a Dodo payment ‚Üí user gets redirected to a hosted checkout page ‚Üí pays ‚Üí lands back on your app with credits added. One serverless function handles the whole thing.

{/* üé® EXCALIDRAW DIAGRAM #2: Payment Flow */}

<img src="/images/payment-flow.svg" alt="Payment flow: User clicks Buy ‚Üí Frontend calls /api/checkout ‚Üí Dodo returns checkout link ‚Üí User pays ‚Üí Redirects back ‚Üí Credits added" />

Here's the core of `api/checkout.js` -- the part that actually talks to Dodo:

```javascript api/checkout.js
const PRODUCTS = {
  starter: { id: 'pdt_YOUR_STARTER_ID', characters: 10000 },
  pro:     { id: 'pdt_YOUR_PRO_ID',     characters: 50000 },
  power:   { id: 'pdt_YOUR_POWER_ID',   characters: 200000 },
};

// The money shot -- one API call, one payment link
const response = await fetch(`${DODO_BASE_URL}/payments`, {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${DODO_API_KEY}`,
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    payment_link: true, // ‚Üê Miss this and you get null. Ask me how I know.
    billing: { city: 'San Francisco', country: 'US', state: 'CA', street: '123 Main St', zipcode: '94102' },
    customer: { email: 'customer@example.com', name: 'Customer' },
    product_cart: [{ product_id: product.id, quantity: 1 }],
    return_url: `${returnUrl}?success=true&characters=${product.characters}`,
  }),
});
```

<Card title="Full checkout handler" icon="github" href="https://github.com/aainanarang29/chirpify-ai/blob/main/api/checkout.js">
  Error handling, env switching, response parsing -- the production-ready version.
</Card>

<Warning>
**`payment_link: true` is non-negotiable.** Without it, `payment_link` comes back `null` and your users stare at a broken button. This is the #1 integration gotcha.
</Warning>

---

## Step 3: Handle Payment Success

After checkout, Dodo bounces users back to your `return_url` with the query params you baked in. Your frontend grabs them and tops up the balance. Simple URL parsing, no webhooks needed for the demo.

```javascript
const urlParams = new URLSearchParams(window.location.search);

if (urlParams.get('success') === 'true') {
  const addedChars = parseInt(urlParams.get('characters') || '0');
  if (addedChars > 0) {
    let credits = parseInt(localStorage.getItem('chirpify_credits') || '500');
    credits += addedChars;
    localStorage.setItem('chirpify_credits', credits.toString());
    window.history.replaceState({}, '', window.location.pathname); // Clean URL
    showToast(`${addedChars.toLocaleString()} characters added!`);
  }
}
```

<Note>
For production, don't trust URL params alone. Set up [Dodo webhooks](https://docs.dodopayments.com) for server-side payment verification. URL params are fine for demos, sketchy for real money.
</Note>

---

## Step 4: Track Usage and Deduct Credits

The rule is simple: check balance first, call the API, deduct only on success. Never charge for a failed generation.

{/* üé® EXCALIDRAW DIAGRAM #3: Credit Deduction Flow */}

<img src="/images/credit-flow.svg" alt="Credit flow: Enter text ‚Üí Enough credits? ‚Üí Yes: generate + deduct + play. No: show pricing modal." />

```javascript
async function generateSpeech(text, voice) {
  const charCost = text.length;
  let credits = parseInt(localStorage.getItem('chirpify_credits') || '500');

  // No credits? Show the upsell.
  if (credits < charCost) {
    showPricingModal();
    return;
  }

  const response = await fetch('/api/speak', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ text, voice }),
  });

  if (!response.ok) throw new Error('Speech generation failed');

  // Only deduct after a successful generation
  credits -= charCost;
  localStorage.setItem('chirpify_credits', credits.toString());
  updateCreditsDisplay();

  const data = await response.json();
  playAudio(data.audio);
}
```

<Card title="Complete usage tracking" icon="github" href="https://github.com/aainanarang29/chirpify-ai/blob/main/public/app.js">
  Full implementation with error handling, loading spinners, and edge cases.
</Card>

---

## Step 5: Build the Pricing UI

When credits run dry, hit them with a clean upgrade modal. Three cards, three price points, one click to checkout.

<img src="/images/chirpify-pricing-modal.png" alt="Chirpify pricing modal" />

Each card carries a `data-pack` attribute that maps to your product config. Click fires `/api/checkout`, response comes back with a Dodo checkout URL, `window.location.href` does the rest. No modals-within-modals, no multi-step forms. Click, pay, done.

<Card title="Pricing modal markup + handlers" icon="github" href="https://github.com/aainanarang29/chirpify-ai/blob/main/public/index.html">
  HTML structure, click handlers, loading states -- ready to drop into your project.
</Card>

---

## Step 6: Display Credit Balance

A live counter in the header that tells users exactly where they stand. Green when healthy, yellow when running low, red when empty. No ambiguity.

```javascript
function updateCreditsDisplay() {
  const credits = parseInt(localStorage.getItem('chirpify_credits') || '500');
  const display = document.querySelector('.credits-number');

  display.textContent = credits >= 1000
    ? (credits / 1000).toFixed(credits % 1000 === 0 ? 0 : 1) + 'K'
    : credits.toString();

  container.classList.toggle('empty', credits <= 0);
  container.classList.toggle('low', credits > 0 && credits < 100);
}
```

Small thing, big impact. Users who can see their balance spend more confidently -- and buy more when it's low.

---

## Step 7: Wire Up ElevenLabs

The TTS endpoint is a thin wrapper around ElevenLabs. Text and voice go in, base64 audio comes out. Your frontend decodes it and plays it.

```javascript api/speak.js
const VOICES = {
  george: 'JBFqnCBsd6RMkjVDRZzb',
  aria: 'Xb7hH8MSUJpSbSDYk0k2',
  roger: 'CwhRBWXzGAHq8TQ4Fs17',
  sarah: 'EXAVITQu4vr4xnSDxMaL',
  charlie: 'IKne3meq5aSn9XLyUdCD',
};

const response = await fetch(
  `https://api.elevenlabs.io/v1/text-to-speech/${voiceId}`,
  {
    method: 'POST',
    headers: { 'xi-api-key': ELEVENLABS_API_KEY, 'Content-Type': 'application/json' },
    body: JSON.stringify({
      text,
      model_id: 'eleven_monolingual_v1',
      voice_settings: { stability: 0.5, similarity_boost: 0.75 },
    }),
  }
);

const audioBuffer = await response.arrayBuffer();
const base64Audio = Buffer.from(audioBuffer).toString('base64');
```

<Card title="Full ElevenLabs handler" icon="github" href="https://github.com/aainanarang29/chirpify-ai/blob/main/api/speak.js">
  Validation, error handling, voice fallbacks -- the complete `api/speak.js`.
</Card>

---

## Deploy It

### Environment Variables

Drop these into Vercel under **Settings ‚Üí Environment Variables**:

| Variable | What it does | Example |
| --- | --- | --- |
| `DODO_PAYMENTS_API_KEY` | Authenticates with Dodo | `sk_test_...` |
| `DODO_ENV` | Switches test/live | `test` |
| `ELEVENLABS_API_KEY` | Authenticates with ElevenLabs | `xi_...` |
| `SITE_URL` | Your app URL (for return redirects) | `https://chirpify-ai.vercel.app` |

### Ship It

```bash
npm install -g vercel
vercel --prod
```

Two commands. That's the whole deploy.

<Accordion title="vercel.json (if you need it)">

```json vercel.json
{
  "framework": null,
  "buildCommand": "",
  "installCommand": "npm install",
  "outputDirectory": "public"
}
```

</Accordion>

---

## Test It

Dodo's test mode gives you a fake card that always succeeds:

| Field | Value |
| --- | --- |
| Card Number | `4242 4242 4242 4242` |
| Expiry | Any future date |
| CVC | Any 3 digits |
| ZIP | Any 5 digits |

**The golden path to verify:** Load the app ‚Üí use your free 500 chars ‚Üí run out ‚Üí pricing modal pops ‚Üí buy Starter Pack with test card ‚Üí get redirected back ‚Üí see 10K chars in your balance ‚Üí generate more speech ‚Üí refresh the page ‚Üí balance persists.

If all of that works, you've got a working SaaS.

---

## Things That'll Save You Debugging Time

<CardGroup cols={2}>
  <Card title="payment_link: true" icon="triangle-exclamation">
    Forget this flag and your checkout URL comes back null. The single most common Dodo integration bug.
  </Card>
  <Card title="localStorage is a demo tool" icon="database">
    It works great here. In production, move credits to a database and validate server-side. Users can edit localStorage in DevTools.
  </Card>
  <Card title="Return URL params" icon="rotate-right">
    Clever for demos -- pass credit count in the URL, parse it on landing. For real apps, use webhooks so credits only add after confirmed payment.
  </Card>
  <Card title="Check credits before API calls" icon="shield-check">
    Never call ElevenLabs without checking balance first. Failed generations that still deduct credits = angry users.
  </Card>
</CardGroup>

---

## Going Live

<Warning>
Everything in this cookbook runs on **test mode**. Flip these switches before taking real payments.
</Warning>

| | Test | Live |
| --- | --- | --- |
| Base URL | `test.dodopayments.com` | `live.dodopayments.com` |
| API Keys | `sk_test_...` | `sk_live_...` |
| Payments | Simulated (no real charges) | Real money |
| Dashboard | [test.dodopayments.com](https://test.dodopayments.com) | [dashboard.dodopayments.com](https://dashboard.dodopayments.com) |

The switch: create live products in the dashboard, generate a live API key, update your Vercel env vars, swap the product IDs in `api/checkout.js`. Test with a real card (you can refund yourself), and you're in business.

---

## Keep Building

<CardGroup cols={3}>
  <Card title="Dodo Payments Docs" icon="book" href="https://docs.dodopayments.com">
    API reference, webhooks, SDKs
  </Card>
  <Card title="ElevenLabs Docs" icon="microphone" href="https://docs.elevenlabs.io">
    Voice models, streaming, cloning
  </Card>
  <Card title="Vercel Docs" icon="rocket" href="https://vercel.com/docs">
    Edge functions, domains, CI/CD
  </Card>
</CardGroup>
