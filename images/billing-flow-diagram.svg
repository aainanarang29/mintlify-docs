<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 400">
  <defs>
    <linearGradient id="teal" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0d9488"/>
      <stop offset="100%" style="stop-color:#14b8a6"/>
    </linearGradient>
    <linearGradient id="purple" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#8b5cf6"/>
      <stop offset="100%" style="stop-color:#a78bfa"/>
    </linearGradient>
    <linearGradient id="orange" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f59e0b"/>
      <stop offset="100%" style="stop-color:#fbbf24"/>
    </linearGradient>
    <linearGradient id="green" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#10b981"/>
      <stop offset="100%" style="stop-color:#34d399"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="3" stdDeviation="3" flood-opacity="0.12"/>
    </filter>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#64748b"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1000" height="400" fill="#f8fafc"/>

  <!-- Title -->
  <text x="500" y="35" text-anchor="middle" font-family="system-ui, sans-serif" font-size="22" font-weight="bold" fill="#1e293b">Payment &amp; Billing Flow</text>

  <!-- Step 1: User clicks Buy -->
  <g filter="url(#shadow)">
    <rect x="30" y="70" width="140" height="90" rx="10" fill="url(#teal)"/>
    <text x="100" y="105" text-anchor="middle" font-family="system-ui, sans-serif" font-size="13" font-weight="bold" fill="white">1. User Clicks</text>
    <text x="100" y="125" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" fill="white" opacity="0.9">"Buy Credits"</text>
    <text x="100" y="145" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="white" opacity="0.7">Selects a pack</text>
  </g>

  <!-- Arrow 1 -->
  <path d="M170 115 L210 115" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arrow)"/>

  <!-- Step 2: Frontend calls API -->
  <g filter="url(#shadow)">
    <rect x="220" y="70" width="140" height="90" rx="10" fill="url(#purple)"/>
    <text x="290" y="105" text-anchor="middle" font-family="system-ui, sans-serif" font-size="13" font-weight="bold" fill="white">2. API Call</text>
    <text x="290" y="125" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" fill="white" opacity="0.9">/api/checkout</text>
    <text x="290" y="145" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="white" opacity="0.7">POST { pack }</text>
  </g>

  <!-- Arrow 2 -->
  <path d="M360 115 L400 115" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arrow)"/>

  <!-- Step 3: Dodo creates payment -->
  <g filter="url(#shadow)">
    <rect x="410" y="70" width="140" height="90" rx="10" fill="url(#orange)"/>
    <text x="480" y="105" text-anchor="middle" font-family="system-ui, sans-serif" font-size="13" font-weight="bold" fill="white">3. Dodo API</text>
    <text x="480" y="125" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" fill="white" opacity="0.9">Creates payment</text>
    <text x="480" y="145" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="white" opacity="0.7">payment_link: true</text>
  </g>

  <!-- Arrow 3 -->
  <path d="M550 115 L590 115" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arrow)"/>

  <!-- Step 4: Returns checkout URL -->
  <g filter="url(#shadow)">
    <rect x="600" y="70" width="140" height="90" rx="10" fill="#3b82f6"/>
    <text x="670" y="105" text-anchor="middle" font-family="system-ui, sans-serif" font-size="13" font-weight="bold" fill="white">4. Checkout URL</text>
    <text x="670" y="125" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" fill="white" opacity="0.9">Returned to app</text>
    <text x="670" y="145" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="white" opacity="0.7">payment_link</text>
  </g>

  <!-- Arrow 4 -->
  <path d="M740 115 L780 115" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arrow)"/>

  <!-- Step 5: Redirect to Dodo -->
  <g filter="url(#shadow)">
    <rect x="790" y="70" width="140" height="90" rx="10" fill="#ec4899"/>
    <text x="860" y="105" text-anchor="middle" font-family="system-ui, sans-serif" font-size="13" font-weight="bold" fill="white">5. Redirect</text>
    <text x="860" y="125" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" fill="white" opacity="0.9">To Dodo checkout</text>
    <text x="860" y="145" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="white" opacity="0.7">User pays</text>
  </g>

  <!-- Arrow down from step 5 -->
  <path d="M860 160 L860 200 L860 220" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arrow)"/>

  <!-- Step 6: Dodo redirects back -->
  <g filter="url(#shadow)">
    <rect x="790" y="230" width="140" height="90" rx="10" fill="url(#orange)"/>
    <text x="860" y="265" text-anchor="middle" font-family="system-ui, sans-serif" font-size="13" font-weight="bold" fill="white">6. Callback</text>
    <text x="860" y="285" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" fill="white" opacity="0.9">Dodo redirects</text>
    <text x="860" y="305" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="white" opacity="0.7">?success=true</text>
  </g>

  <!-- Arrow 6 -->
  <path d="M790 275 L590 275" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arrow)"/>

  <!-- Step 7: Parse URL params -->
  <g filter="url(#shadow)">
    <rect x="440" y="230" width="140" height="90" rx="10" fill="url(#purple)"/>
    <text x="510" y="265" text-anchor="middle" font-family="system-ui, sans-serif" font-size="13" font-weight="bold" fill="white">7. Parse URL</text>
    <text x="510" y="285" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" fill="white" opacity="0.9">Extract chars</text>
    <text x="510" y="305" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="white" opacity="0.7">&amp;characters=10000</text>
  </g>

  <!-- Arrow 7 -->
  <path d="M440 275 L240 275" stroke="#64748b" stroke-width="2" fill="none" marker-end="url(#arrow)"/>

  <!-- Step 8: Update credits -->
  <g filter="url(#shadow)">
    <rect x="90" y="230" width="140" height="90" rx="10" fill="url(#green)"/>
    <text x="160" y="265" text-anchor="middle" font-family="system-ui, sans-serif" font-size="13" font-weight="bold" fill="white">8. Add Credits</text>
    <text x="160" y="285" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" fill="white" opacity="0.9">localStorage</text>
    <text x="160" y="305" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="white" opacity="0.7">credits += 10000</text>
  </g>

  <!-- Success checkmark -->
  <circle cx="160" cy="355" r="20" fill="#10b981"/>
  <path d="M150 355 L157 362 L172 347" stroke="white" stroke-width="3" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
  <text x="200" y="360" font-family="system-ui, sans-serif" font-size="14" font-weight="600" fill="#10b981">Credits updated! User can generate speech.</text>
</svg>
